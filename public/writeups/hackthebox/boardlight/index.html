<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>BoardLight Writeup - HackTheBox | Rezy Dev</title>
<meta name="keywords" content="HackTheBox, Linux, Easy">
<meta name="description" content="BoardLight is an easy Linux machine exploiting Dolibarr CVE-2023-30253 to gain www-data, then SSH access via plaintext creds. Privilege escalation is achieved through a vulnerable SUID Enlightenment binary (CVE-2022-37706) for root access.">
<meta name="author" content="Me">
<link rel="canonical" href="http://localhost:1313/writeups/hackthebox/boardlight/">
<meta name="google-site-verification" content="XYZabc">
<meta name="yandex-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.c8cc592602af07182c5c77ec685d5a345edaf450c20eb609706f559cb037baef.css" integrity="sha256-yMxZJgKvBxgsXHfsaF1aNF7a9FDCDrYJcG9VnLA3uu8=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/hackthebox/boardlight/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {
         
        .post-content input[type="checkbox"]:checked ~ label > img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }
    
        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
    </style><meta property="og:url" content="http://localhost:1313/writeups/hackthebox/boardlight/">
  <meta property="og:site_name" content="Rezy Dev">
  <meta property="og:title" content="BoardLight Writeup - HackTheBox">
  <meta property="og:description" content="BoardLight is an easy Linux machine exploiting Dolibarr CVE-2023-30253 to gain www-data, then SSH access via plaintext creds. Privilege escalation is achieved through a vulnerable SUID Enlightenment binary (CVE-2022-37706) for root access.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-10-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-10T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Easy">
    <meta property="og:image" content="http://localhost:1313/feature.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/feature.png">
<meta name="twitter:title" content="BoardLight Writeup - HackTheBox">
<meta name="twitter:description" content="BoardLight is an easy Linux machine exploiting Dolibarr CVE-2023-30253 to gain www-data, then SSH access via plaintext creds. Privilege escalation is achieved through a vulnerable SUID Enlightenment binary (CVE-2022-37706) for root access.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "http://localhost:1313/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "HackTheBox",
      "item": "http://localhost:1313/writeups/hackthebox/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "BoardLight Writeup - HackTheBox",
      "item": "http://localhost:1313/writeups/hackthebox/boardlight/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BoardLight Writeup - HackTheBox",
  "name": "BoardLight Writeup - HackTheBox",
  "description": "BoardLight is an easy Linux machine exploiting Dolibarr CVE-2023-30253 to gain www-data, then SSH access via plaintext creds. Privilege escalation is achieved through a vulnerable SUID Enlightenment binary (CVE-2022-37706) for root access.",
  "keywords": [
    "HackTheBox", "Linux", "Easy"
  ],
  "articleBody": " Link: https://app.hackthebox.com/machines/BoardLight Difficulty Easy Machine Linux Enumeration I ran the Nmap command to find all available open ports on this system using the command: nmap 10.10.11.11 -T4 -vv.\n**PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack** Again, I ran an aggressive scan using the command: sudo nmap 10.10.11.11 -T4 -p22,80 -A -sC -sV -O -vv. While it ran, I was looking at port 80 and enumerating the web server.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDH0dV4gtJNo8ixEEBDxhUId6Pc/8iNLX16+zpUCIgmxxl5TivDMLg2JvXorp4F2r8ci44CESUlnMHRSYNtlLttiIZHpTML7ktFHbNexvOAJqE1lIlQlGjWBU1hWq6Y6n1tuUANOd5U+Yc0/h53gKu5nXTQTy1c9CLbQfaYvFjnzrR3NQ6Hw7ih5u3mEjJngP+Sq+dpzUcnFe1BekvBPrxdAJwN6w+MSpGFyQSAkUthrOE4JRnpa6jSsTjXODDjioNkp2NLkKa73Yc2DHk3evNUXfa+P8oWFBk8ZXSHFyeOoNkcqkPCrkevB71NdFtn3Fd/Ar07co0ygw90Vb2q34cu1Jo/1oPV1UFsvcwaKJuxBKozH+VA0F9hyriPKjsvTRCbkFjweLxCib5phagHu6K5KEYC+VmWbCUnWyvYZauJ1/t5xQqqi9UWssRjbE1mI0Krq2Zb97qnONhzcclAPVpvEVdCCcl0rYZjQt6VI1PzHha56JepZCFCNvX3FVxYzEk= | 256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK7G5PgPkbp1awVqM5uOpMJ/xVrNirmwIT21bMG/+jihUY8rOXxSbidRfC9KgvSDC4flMsPZUrWziSuBDJAra5g= | 256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILHj/lr3X40pR3k9+uYJk4oSjdULCK0DlOxbiL66ZRWg 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Site doesn't have a title (text/html; charset=UTF-8). Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.94SVN%E=4%D=5/26%OT=22%CT=%CU=35758%PV=Y%DS=2%DC=T%G=N%TM=6652CBFE%P=x86_64-pc-linux-gnu) SEQ(SP=107%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A) OPS(O1=M552ST11NW7%O2=M552ST11NW7%O3=M552NNT11NW7%O4=M552ST11NW7%O5=M552ST11NW7%O6=M552ST11) WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88) ECN(R=Y%DF=Y%T=40%W=FAF0%O=M552NNSNW7%CC=Y%Q=) T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G) IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 29.321 days (since Fri Apr 26 18:00:39 2024) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=263 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 22/tcp) HOP RTT ADDRESS 1 95.49 ms 10.10.14.1 2 91.74 ms 10.10.11.11 This is what the website looks like.\nI checked the newsletter form, contact form, and looked around the website. It doesn’t seem to work at all, so the injection point is probably not in this asset. We can try subdomain brute forcing and directory brute forcing now.\nI will first conduct directory brute forcing using Gobuster:\n┌──(kali㉿kali)-[~] └─$ gobuster dir -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://board.htb/ [+] Method: GET [+] Threads: 90 [+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 307] [--\u003e http://board.htb/images/] /css (Status: 301) [Size: 304] [--\u003e http://board.htb/css/] /js (Status: 301) [Size: 303] [--\u003e http://board.htb/js/] /server-status (Status: 403) [Size: 274] Nothing interesting with the directories. We might check the JS and source codes, but they don’t seem promising at the moment. Before checking the source code, we can try subdomain brute forcing using Gobuster again:\n┌──(kali㉿kali)-[~] └─$ gobuster vhost -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain --exclude-length 301 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://board.htb/ [+] Method: GET [+] Threads: 90 [+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt [+] User Agent: gobuster/3.6 [+] Timeout: 10s [+] Append Domain: true [+] Exclude Length: 301 =============================================================== Starting gobuster in VHOST enumeration mode =============================================================== Found: crm.board.htb Status: 200 [Size: 6360] Found: CRM.board.htb Status: 200 [Size: 6360] I added the newly found subdomain to my /etc/hosts file to gain access to it.\n┌──(root㉿kali)-[/home/kali] └─# cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 kali ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 10.10.11.11 board.htb crm.board.htb Accessing the web page, we see it’s Dolibarr 17.0.0. Dolibarr ERP \u0026 CRM is modular business management software that adapts to the size of the company (SMEs, large companies, freelancers, or associations).\nAfter doing a few research on this version of Dolibarr, I found a CVE associated with it: https://www.swascan.com/security-advisory-dolibarr-17-0-0/\nUser Flag This CVE allows us to execute Authenticated PHP Code Injection. So we need to be authenticated before we can inject PHP code. Trying the default username and password admin:admin worked perfectly as expected.\nI followed the Proof of Concept (PoC) from the above URL by creating a web page from the “Websites” tab, then changing the HTML source to add our PHP reverse shell payload and get a reverse shell.\nThe PHP code is flagged as disabled; however, it’s still possible to inject PHP code as the Test user by typing \u003c?PHP code…?\u003e instead of \u003c?php code..?\u003e.\nBefore injecting, I have netcat actively listening on port 6969. (nc -nvlp 6969)\nOnce the injected payload is executed and we visit the site, I can see the shell popped up in my netcat session. I will quickly stabilize the shell with a Python TTY shell. With the shell as www-data, I will run LinPEAS to see if we have a vector to laterally move to the user Larissa.\nAfter enumerating on my own without using LinPEAS, I found interesting stuff in /var/www/html/crm.board.htb/htdocs/conf/conf.php.\n$dolibarr_main_url_root='http://crm.board.htb'; $dolibarr_main_document_root='/var/www/html/crm.board.htb/htdocs'; $dolibarr_main_url_root_alt='/custom'; $dolibarr_main_document_root_alt='/var/www/html/crm.board.htb/htdocs/custom'; $dolibarr_main_data_root='/var/www/html/crm.board.htb/documents'; $dolibarr_main_db_host='localhost'; $dolibarr_main_db_port='3306'; $dolibarr_main_db_name='dolibarr'; $dolibarr_main_db_prefix='llx_'; $dolibarr_main_db_user='dolibarrowner'; $dolibarr_main_db_pass='serverfun2$2023!!'; $dolibarr_main_db_type='mysqli'; $dolibarr_main_db_character_set='utf8'; $dolibarr_main_db_collation='utf8_unicode_ci'; // Authentication settings $dolibarr_main_authentication='dolibarr'; //$dolibarr_main_demo='autologin,autopass'; // Security settings $dolibarr_main_prod='0'; $dolibarr_main_force_https='0'; $dolibarr_main_restrict_os_commands='mysqldump, mysql, pg_dump, pgrestore'; $dolibarr_nocsrfcheck='0'; $dolibarr_main_instance_unique_id='ef9a8f59524328e3c36894a9ff0562b5'; $dolibarr_mailing_limit_sendbyweb='0'; $dolibarr_mailing_limit_sendbycli='0'; Here in this config file, I found the database username and password. I will use the MySQL command like this to log in to the database:\nmysql -u dolibarrowner -p (and password as: serverfun2$2023!!)\nI can see the database names with SHOW DATABASES; too, but we already know the database name from the above config. I will select this database using use dolibarr; and try to see the available tables using SHOW TABLES;. I then executed:\nSELECT * FROM llx_user; I selected the interesting stuff from MySQL.\nmysql\u003e select admin, pass_crypted, api_key, firstname, lastname from llx_user; +-------+--------------------------------------------------------------+--------------+-----------+------------+ | admin | pass_crypted | api_key | firstname | lastname | +-------+--------------------------------------------------------------+--------------+-----------+------------+ | 1 | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm | NULL | | SuperAdmin | | 0 | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 | yr6V3pXd9QEI | | admin | +-------+--------------------------------------------------------------+--------------+-----------+------------+ 2 rows in set (0.00 sec) I attempted to crack the first hash, which unfortunately remained uncracked. However, after a bit of frustration, I realized that the user password and the database password are the same. So, I SSHed to the user account with:\nssh larissa@board.htb and used the password (serverfun2$2023!!) obtained from the conf.php file. And there we go, we have the user flag now.\nRoot Flag I quickly transferred LinPEAS to the target machine and ran it to see if there is any privilege escalation vector.\nHowever, what I noticed is that this box had desktop, document, and picture files in the /home/larissa directory, which is not normal for a typical Linux server. This anomaly is likely due to the desktop environment installed on this box. So, I quickly tried to enumerate what desktop environment this box uses. It turns out this box uses version 0.23.1 of the Enlightenment desktop environment.\nAfter conducting some research, I found a working privilege escalation CVE associated with this desktop environment. The Proof of Concept (PoC) of the CVE can be found at: https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit.\nThe Enlightenment Version: 0.25.3 is indeed vulnerable to local privilege escalation. The vulnerability lies in Enlightenment_sys before version 0.25.3, which allows local users to gain privileges because it is setuid root. The issue arises from the mishandling of pathnames that begin with a /dev/.. substring. If an attacker has local access to a machine on which Enlightenment is installed, they can exploit this vulnerability to execute potentially dangerous actions.\nI created an exploit.sh script in the /tmp directory and granted it execute permissions with chmod +x exploit.sh. Then, I executed the bash script downloaded from the GitHub link of the PoC, and, boom, we obtained a root shell.\nConclusion Thanks for following my write-up. Keep learning and happy hacking! 🙂\n",
  "wordCount" : "1269",
  "inLanguage": "en",
  "image":"http://localhost:1313/feature.png","datePublished": "2024-10-10T00:00:00Z",
  "dateModified": "2024-10-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/writeups/hackthebox/boardlight/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rezy Dev",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="rezydev.xyz (Alt + H)">rezydev.xyz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about/" title="👨🏼‍💻 About">
                    <span>👨🏼‍💻 About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups/" title="✍️ Writeups">
                    <span>✍️ Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="📂 Archives">
                    <span>📂 Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="🏷️ Tags">
                    <span>🏷️ Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="🔍 Search (Alt &#43; /)" accesskey=/>
                    <span>🔍 Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/">Writeups</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/hackthebox/">HackTheBox</a></div>
    <h1 class="post-title entry-hint-parent">
      BoardLight Writeup - HackTheBox
    </h1>
    <div class="post-description">
      BoardLight is an easy Linux machine exploiting Dolibarr CVE-2023-30253 to gain www-data, then SSH access via plaintext creds. Privilege escalation is achieved through a vulnerable SUID Enlightenment binary (CVE-2022-37706) for root access.
    </div>
    <div class="post-meta"><span title='2024-10-10 00:00:00 +0000 UTC'>October 10, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1269 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href="https://github.com/Rezy-Dev/Rezy-Dev.github.io/tree/master/content/writeups/HackTheBox/BoardLight/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
            <img loading="eager" src="http://localhost:1313/writeups/hackthebox/boardlight/feature.png" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a></li>
    <li><a href="#user-flag">User Flag</a></li>
    <li><a href="#root-flag">Root Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><table>
  <thead>
      <tr>
          <th>Link:</th>
          <th><a href="https://app.hackthebox.com/machines/BoardLight">https://app.hackthebox.com/machines/BoardLight</a></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Difficulty</td>
          <td>Easy</td>
      </tr>
      <tr>
          <td>Machine</td>
          <td>Linux</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="enumeration">Enumeration<a hidden class="anchor" aria-hidden="true" href="#enumeration">#</a></h2>
<p>I ran the Nmap command to find all available open ports on this system using the command: <code>nmap 10.10.11.11 -T4 -vv</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">**PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack**
</span></span></code></pre></div><p>Again, I ran an aggressive scan using the command: <strong><code>sudo nmap 10.10.11.11 -T4 -p22,80 -A -sC -sV -O -vv</code></strong>. While it ran, I was looking at port 80 and enumerating the web server.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">PORT   STATE SERVICE REASON         VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA)
</span></span><span class="line"><span class="cl">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDH0dV4gtJNo8ixEEBDxhUId6Pc/8iNLX16+zpUCIgmxxl5TivDMLg2JvXorp4F2r8ci44CESUlnMHRSYNtlLttiIZHpTML7ktFHbNexvOAJqE1lIlQlGjWBU1hWq6Y6n1tuUANOd5U+Yc0/h53gKu5nXTQTy1c9CLbQfaYvFjnzrR3NQ6Hw7ih5u3mEjJngP+Sq+dpzUcnFe1BekvBPrxdAJwN6w+MSpGFyQSAkUthrOE4JRnpa6jSsTjXODDjioNkp2NLkKa73Yc2DHk3evNUXfa+P8oWFBk8ZXSHFyeOoNkcqkPCrkevB71NdFtn3Fd/Ar07co0ygw90Vb2q34cu1Jo/1oPV1UFsvcwaKJuxBKozH+VA0F9hyriPKjsvTRCbkFjweLxCib5phagHu6K5KEYC+VmWbCUnWyvYZauJ1/t5xQqqi9UWssRjbE1mI0Krq2Zb97qnONhzcclAPVpvEVdCCcl0rYZjQt6VI1PzHha56JepZCFCNvX3FVxYzEk=
</span></span><span class="line"><span class="cl">|   256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA)
</span></span><span class="line"><span class="cl">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK7G5PgPkbp1awVqM5uOpMJ/xVrNirmwIT21bMG/+jihUY8rOXxSbidRfC9KgvSDC4flMsPZUrWziSuBDJAra5g=
</span></span><span class="line"><span class="cl">|   256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519)
</span></span><span class="line"><span class="cl">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILHj/lr3X40pR3k9+uYJk4oSjdULCK0DlOxbiL66ZRWg
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span class="line"><span class="cl">|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
</span></span><span class="line"><span class="cl">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span><span class="line"><span class="cl">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
</span></span><span class="line"><span class="cl">Aggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)
</span></span><span class="line"><span class="cl">No exact OS matches for host (test conditions non-ideal).
</span></span><span class="line"><span class="cl">TCP/IP fingerprint:
</span></span><span class="line"><span class="cl">SCAN(V=7.94SVN%E=4%D=5/26%OT=22%CT=%CU=35758%PV=Y%DS=2%DC=T%G=N%TM=6652CBFE%P=x86_64-pc-linux-gnu)
</span></span><span class="line"><span class="cl">SEQ(SP=107%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)
</span></span><span class="line"><span class="cl">OPS(O1=M552ST11NW7%O2=M552ST11NW7%O3=M552NNT11NW7%O4=M552ST11NW7%O5=M552ST11NW7%O6=M552ST11)
</span></span><span class="line"><span class="cl">WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)
</span></span><span class="line"><span class="cl">ECN(R=Y%DF=Y%T=40%W=FAF0%O=M552NNSNW7%CC=Y%Q=)
</span></span><span class="line"><span class="cl">T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)
</span></span><span class="line"><span class="cl">T2(R=N)
</span></span><span class="line"><span class="cl">T3(R=N)
</span></span><span class="line"><span class="cl">T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)
</span></span><span class="line"><span class="cl">IE(R=Y%DFI=N%T=40%CD=S)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uptime guess: 29.321 days (since Fri Apr 26 18:00:39 2024)
</span></span><span class="line"><span class="cl">Network Distance: 2 hops
</span></span><span class="line"><span class="cl">TCP Sequence Prediction: Difficulty=263 (Good luck!)
</span></span><span class="line"><span class="cl">IP ID Sequence Generation: All zeros
</span></span><span class="line"><span class="cl">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TRACEROUTE (using port 22/tcp)
</span></span><span class="line"><span class="cl">HOP RTT      ADDRESS
</span></span><span class="line"><span class="cl">1   95.49 ms 10.10.14.1
</span></span><span class="line"><span class="cl">2   91.74 ms 10.10.11.11
</span></span></code></pre></div><p>This is what the website looks like.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-77a5a" hidden>
    <label for="zoomCheck-77a5a">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled.png" alt="Untitled" 
             />
    </label></p>
<p>I checked the newsletter form, contact form, and looked around the website. It doesn’t seem to work at all, so the injection point is probably not in this asset. We can try subdomain brute forcing and directory brute forcing now.</p>
<p>I will first conduct directory brute forcing using Gobuster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">┌──(kali㉿kali)-[~]
</span></span><span class="line"><span class="cl">└─$ gobuster dir -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) <span class="err">&amp;</span> Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://board.htb/
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 90
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/images               (Status: 301) [Size: 307] [--&gt; http://board.htb/images/]
</span></span><span class="line"><span class="cl">/css                  (Status: 301) [Size: 304] [--&gt; http://board.htb/css/]
</span></span><span class="line"><span class="cl">/js                   (Status: 301) [Size: 303] [--&gt; http://board.htb/js/]
</span></span><span class="line"><span class="cl">/server-status        (Status: 403) [Size: 274]
</span></span></code></pre></div><p>Nothing interesting with the directories. We might check the JS and source codes, but they don’t seem promising at the moment. Before checking the source code, we can try subdomain brute forcing using Gobuster again:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">┌──(kali㉿kali)-[~]
</span></span><span class="line"><span class="cl">└─$ gobuster vhost -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain --exclude-length 301
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) <span class="err">&amp;</span> Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:              http://board.htb/
</span></span><span class="line"><span class="cl">[+] Method:           GET
</span></span><span class="line"><span class="cl">[+] Threads:          90
</span></span><span class="line"><span class="cl">[+] Wordlist:         /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">[+] User Agent:       gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:          10s
</span></span><span class="line"><span class="cl">[+] Append Domain:    true
</span></span><span class="line"><span class="cl">[+] Exclude Length:   301
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in VHOST enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Found: crm.board.htb Status: 200 [Size: 6360]
</span></span><span class="line"><span class="cl">Found: CRM.board.htb Status: 200 [Size: 6360]
</span></span></code></pre></div><p>I added the newly found subdomain to my <code>/etc/hosts</code> file to gain access to it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">┌──(root㉿kali)-[/home/kali]
</span></span><span class="line"><span class="cl">└─# cat /etc/hosts
</span></span><span class="line"><span class="cl">127.0.0.1       localhost
</span></span><span class="line"><span class="cl">127.0.1.1       kali
</span></span><span class="line"><span class="cl">::1             localhost ip6-localhost ip6-loopback
</span></span><span class="line"><span class="cl">ff02::1         ip6-allnodes
</span></span><span class="line"><span class="cl">ff02::2         ip6-allrouters
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">10.10.11.11 board.htb crm.board.htb
</span></span></code></pre></div><p>Accessing the web page, we see it’s Dolibarr 17.0.0. Dolibarr ERP &amp; CRM is modular business management software that adapts to the size of the company (SMEs, large companies, freelancers, or associations).</p>
<p>
    
    <input type="checkbox" id="zoomCheck-e808e" hidden>
    <label for="zoomCheck-e808e">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%201.png" alt="Untitled" 
             />
    </label></p>
<p>After doing a few research on this version of Dolibarr, I found a CVE associated with it: <a href="https://www.swascan.com/security-advisory-dolibarr-17-0-0/">https://www.swascan.com/security-advisory-dolibarr-17-0-0/</a></p>
<h2 id="user-flag">User Flag<a hidden class="anchor" aria-hidden="true" href="#user-flag">#</a></h2>
<p>This CVE allows us to execute Authenticated PHP Code Injection. So we need to be authenticated before we can inject PHP code. Trying the default username and password <strong><code>admin:admin</code></strong> worked perfectly as expected.</p>
<p>I followed the Proof of Concept (PoC) from the above URL by creating a web page from the “Websites” tab, then changing the HTML source to add our PHP reverse shell payload and get a reverse shell.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-d2c99" hidden>
    <label for="zoomCheck-d2c99">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%202.png" alt="Untitled" 
             />
    </label></p>
<p>The PHP code is flagged as disabled; however, it’s still possible to inject PHP code as the Test user by typing <strong><code>&lt;?PHP code…?&gt;</code></strong> instead of <strong><code>&lt;?php code..?&gt;</code></strong>.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-16609" hidden>
    <label for="zoomCheck-16609">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%203.png" alt="Untitled" 
             />
    </label></p>
<p>Before injecting, I have netcat actively listening on port 6969. (nc -nvlp 6969)</p>
<p>Once the injected payload is executed and we visit the site, I can see the shell popped up in my netcat session. I will quickly stabilize the shell with a Python TTY shell. With the shell as www-data, I will run LinPEAS to see if we have a vector to laterally move to the user Larissa.</p>
<p>After enumerating on my own without using LinPEAS, I found interesting stuff in <strong><code>/var/www/html/crm.board.htb/htdocs/conf/conf.php</code></strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">$dolibarr_main_url_root=&#39;http://crm.board.htb&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_document_root=&#39;/var/www/html/crm.board.htb/htdocs&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_url_root_alt=&#39;/custom&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_document_root_alt=&#39;/var/www/html/crm.board.htb/htdocs/custom&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_data_root=&#39;/var/www/html/crm.board.htb/documents&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_host=&#39;localhost&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_port=&#39;3306&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_name=&#39;dolibarr&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_prefix=&#39;llx_&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_user=&#39;dolibarrowner&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_pass=&#39;serverfun2$2023!!&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_type=&#39;mysqli&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_character_set=&#39;utf8&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_collation=&#39;utf8_unicode_ci&#39;;
</span></span><span class="line"><span class="cl">// Authentication settings
</span></span><span class="line"><span class="cl">$dolibarr_main_authentication=&#39;dolibarr&#39;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//$dolibarr_main_demo=&#39;autologin,autopass&#39;;
</span></span><span class="line"><span class="cl">// Security settings
</span></span><span class="line"><span class="cl">$dolibarr_main_prod=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_force_https=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_restrict_os_commands=&#39;mysqldump, mysql, pg_dump, pgrestore&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_nocsrfcheck=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_instance_unique_id=&#39;ef9a8f59524328e3c36894a9ff0562b5&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_mailing_limit_sendbyweb=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_mailing_limit_sendbycli=&#39;0&#39;;
</span></span></code></pre></div><p>Here in this config file, I found the database username and password. I will use the MySQL command like this to log in to the database:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -u dolibarrowner -p
</span></span></code></pre></div><p>(and password as: <strong><code>serverfun2$2023!!</code></strong>)</p>
<p>I can see the database names with <strong><code>SHOW DATABASES;</code></strong> too, but we already know the database name from the above config. I will select this database using <strong><code>use dolibarr;</code></strong> and try to see the available tables using <strong><code>SHOW TABLES;</code></strong>. I then executed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">llx_user</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>I selected the interesting stuff from MySQL.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">mysql&gt; select admin, pass_crypted, api_key, firstname, lastname from llx_user;
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">| admin | pass_crypted                                                 | api_key      | firstname | lastname   |
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">|     1 | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm | NULL         |           | SuperAdmin |
</span></span><span class="line"><span class="cl">|     0 | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 | yr6V3pXd9QEI |           | admin      |
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">2 rows in set (0.00 sec)
</span></span></code></pre></div><p>I attempted to crack the first hash, which unfortunately remained uncracked. However, after a bit of frustration, I realized that the user password and the database password are the same. So, I SSHed to the user account with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh larissa@board.htb
</span></span></code></pre></div><p>and used the password (<strong><code>serverfun2$2023!!</code></strong>) obtained from the <strong><code>conf.php</code></strong> file. And there we go, we have the user flag now.</p>
<h2 id="root-flag">Root Flag<a hidden class="anchor" aria-hidden="true" href="#root-flag">#</a></h2>
<p>I quickly transferred LinPEAS to the target machine and ran it to see if there is any privilege escalation vector.</p>
<p>However, what I noticed is that this box had desktop, document, and picture files in the <strong><code>/home/larissa</code></strong> directory, which is not normal for a typical Linux server. This anomaly is likely due to the desktop environment installed on this box. So, I quickly tried to enumerate what desktop environment this box uses. It turns out this box uses version 0.23.1 of the Enlightenment desktop environment.</p>
<p>
    
    <input type="checkbox" id="zoomCheck-46dfe" hidden>
    <label for="zoomCheck-46dfe">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%204.png" alt="Untitled" 
             />
    </label></p>
<p>After conducting some research, I found a working privilege escalation CVE associated with this desktop environment. The Proof of Concept (PoC) of the CVE can be found at: <a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit</a>.</p>
<p>The Enlightenment Version: 0.25.3 is indeed vulnerable to local privilege escalation. The vulnerability lies in <strong><code>Enlightenment_sys</code></strong> before version 0.25.3, which allows local users to gain privileges because it is setuid root. The issue arises from the mishandling of pathnames that begin with a <strong><code>/dev/..</code></strong> substring. If an attacker has local access to a machine on which Enlightenment is installed, they can exploit this vulnerability to execute potentially dangerous actions.</p>
<p>I created an <strong><code>exploit.sh</code></strong> script in the <strong><code>/tmp</code></strong> directory and granted it execute permissions with <strong><code>chmod +x exploit.sh</code></strong>. Then, I executed the bash script downloaded from the GitHub link of the PoC, and, boom, we obtained a root shell.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Thanks for following my write-up. Keep learning and happy hacking! 🙂</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/hackthebox/">HackTheBox</a></li>
      <li><a href="http://localhost:1313/tags/linux/">Linux</a></li>
      <li><a href="http://localhost:1313/tags/easy/">Easy</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/writeups/hackthebox/freelancer/">
    <span class="title">« Prev</span>
    <br>
    <span>Freelancer Writeup - HackTheBox</span>
  </a>
  <a class="next" href="http://localhost:1313/writeups/hackthebox/editorial/">
    <span class="title">Next »</span>
    <br>
    <span>Editorial Writeup - HackTheBox</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Rezy Dev</a></span> · 

    <span>
        <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="noopener noreferrer" target="_blank">Some rights reserved</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
