<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>BoardLight Writeup - HackTheBox | Rezy Dev</title>
<meta name="keywords" content="HackTheBox, Linux, Easy">
<meta name="description" content="BoardLight is an easy difficulty Linux machine that features a Dolibarr instance vulnerable to [CVE-2023-30253](https://nvd.nist.gov/vuln/detail/CVE-2023-30253). This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via [CVE-2022-37706](https://nvd.nist.gov/vuln/detail/CVE-2022-37706) and can be abused to leverage a root shell.">
<meta name="author" content="Me">
<link rel="canonical" href="http://localhost:1313/posts/writeups/hackthebox/boardlight/">
<meta name="google-site-verification" content="XYZabc">
<meta name="yandex-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.dedc6f28e91e91324ecfccf7c36e0bac426c203d8e6217a97f0064ab55f9a7cf.css" integrity="sha256-3txvKOkekTJOz8z3w24LrEJsID2OYhepfwBkq1X5p88=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/writeups/hackthebox/boardlight/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/writeups/hackthebox/boardlight/">
  <meta property="og:site_name" content="Rezy Dev">
  <meta property="og:title" content="BoardLight Writeup - HackTheBox">
  <meta property="og:description" content="BoardLight is an easy difficulty Linux machine that features a Dolibarr instance vulnerable to [CVE-2023-30253](https://nvd.nist.gov/vuln/detail/CVE-2023-30253). This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via [CVE-2022-37706](https://nvd.nist.gov/vuln/detail/CVE-2022-37706) and can be abused to leverage a root shell.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-10T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Easy">
      <meta property="og:image" content="http://localhost:1313/posts/writeups/hackthebox/boardlight/feature.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/posts/writeups/hackthebox/boardlight/feature.png">
<meta name="twitter:title" content="BoardLight Writeup - HackTheBox">
<meta name="twitter:description" content="BoardLight is an easy difficulty Linux machine that features a Dolibarr instance vulnerable to [CVE-2023-30253](https://nvd.nist.gov/vuln/detail/CVE-2023-30253). This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via [CVE-2022-37706](https://nvd.nist.gov/vuln/detail/CVE-2022-37706) and can be abused to leverage a root shell.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Writeups",
      "item": "http://localhost:1313/posts/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "HackTheBox",
      "item": "http://localhost:1313/posts/writeups/hackthebox/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "BoardLight Writeup - HackTheBox",
      "item": "http://localhost:1313/posts/writeups/hackthebox/boardlight/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BoardLight Writeup - HackTheBox",
  "name": "BoardLight Writeup - HackTheBox",
  "description": "BoardLight is an easy difficulty Linux machine that features a Dolibarr instance vulnerable to [CVE-2023-30253](https://nvd.nist.gov/vuln/detail/CVE-2023-30253). This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via [CVE-2022-37706](https://nvd.nist.gov/vuln/detail/CVE-2022-37706) and can be abused to leverage a root shell.",
  "keywords": [
    "HackTheBox", "Linux", "Easy"
  ],
  "articleBody": " Link: https://app.hackthebox.com/machines/BoardLight Difficulty Easy Machine Linux Enumeration I ran the Nmap command to find all available open ports on this system using the command: nmap 10.10.11.11 -T4 -vv.\n**PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack** Again, I ran an aggressive scan using the command: sudo nmap 10.10.11.11 -T4 -p22,80 -A -sC -sV -O -vv. While it ran, I was looking at port 80 and enumerating the web server.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDH0dV4gtJNo8ixEEBDxhUId6Pc/8iNLX16+zpUCIgmxxl5TivDMLg2JvXorp4F2r8ci44CESUlnMHRSYNtlLttiIZHpTML7ktFHbNexvOAJqE1lIlQlGjWBU1hWq6Y6n1tuUANOd5U+Yc0/h53gKu5nXTQTy1c9CLbQfaYvFjnzrR3NQ6Hw7ih5u3mEjJngP+Sq+dpzUcnFe1BekvBPrxdAJwN6w+MSpGFyQSAkUthrOE4JRnpa6jSsTjXODDjioNkp2NLkKa73Yc2DHk3evNUXfa+P8oWFBk8ZXSHFyeOoNkcqkPCrkevB71NdFtn3Fd/Ar07co0ygw90Vb2q34cu1Jo/1oPV1UFsvcwaKJuxBKozH+VA0F9hyriPKjsvTRCbkFjweLxCib5phagHu6K5KEYC+VmWbCUnWyvYZauJ1/t5xQqqi9UWssRjbE1mI0Krq2Zb97qnONhzcclAPVpvEVdCCcl0rYZjQt6VI1PzHha56JepZCFCNvX3FVxYzEk= | 256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK7G5PgPkbp1awVqM5uOpMJ/xVrNirmwIT21bMG/+jihUY8rOXxSbidRfC9KgvSDC4flMsPZUrWziSuBDJAra5g= | 256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILHj/lr3X40pR3k9+uYJk4oSjdULCK0DlOxbiL66ZRWg 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Site doesn't have a title (text/html; charset=UTF-8). Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.94SVN%E=4%D=5/26%OT=22%CT=%CU=35758%PV=Y%DS=2%DC=T%G=N%TM=6652CBFE%P=x86_64-pc-linux-gnu) SEQ(SP=107%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A) OPS(O1=M552ST11NW7%O2=M552ST11NW7%O3=M552NNT11NW7%O4=M552ST11NW7%O5=M552ST11NW7%O6=M552ST11) WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88) ECN(R=Y%DF=Y%T=40%W=FAF0%O=M552NNSNW7%CC=Y%Q=) T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G) IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 29.321 days (since Fri Apr 26 18:00:39 2024) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=263 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 22/tcp) HOP RTT ADDRESS 1 95.49 ms 10.10.14.1 2 91.74 ms 10.10.11.11 This is what the website looks like.\nI checked the newsletter form, contact form, and looked around the website. It doesn‚Äôt seem to work at all, so the injection point is probably not in this asset. We can try subdomain brute forcing and directory brute forcing now.\nI will first conduct directory brute forcing using Gobuster:\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ gobuster dir -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://board.htb/ [+] Method: GET [+] Threads: 90 [+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 307] [--\u003e http://board.htb/images/] /css (Status: 301) [Size: 304] [--\u003e http://board.htb/css/] /js (Status: 301) [Size: 303] [--\u003e http://board.htb/js/] /server-status (Status: 403) [Size: 274] Nothing interesting with the directories. We might check the JS and source codes, but they don‚Äôt seem promising at the moment. Before checking the source code, we can try subdomain brute forcing using Gobuster again:\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ gobuster vhost -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain --exclude-length 301 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://board.htb/ [+] Method: GET [+] Threads: 90 [+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt [+] User Agent: gobuster/3.6 [+] Timeout: 10s [+] Append Domain: true [+] Exclude Length: 301 =============================================================== Starting gobuster in VHOST enumeration mode =============================================================== Found: crm.board.htb Status: 200 [Size: 6360] Found: CRM.board.htb Status: 200 [Size: 6360] I added the newly found subdomain to my /etc/hosts file to gain access to it.\n‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali] ‚îî‚îÄ# cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 kali ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 10.10.11.11 board.htb crm.board.htb Accessing the web page, we see it‚Äôs Dolibarr 17.0.0. Dolibarr ERP \u0026 CRM is modular business management software that adapts to the size of the company (SMEs, large companies, freelancers, or associations).\nAfter doing a few research on this version of Dolibarr, I found a CVE associated with it: https://www.swascan.com/security-advisory-dolibarr-17-0-0/\nUser Flag This CVE allows us to execute Authenticated PHP Code Injection. So we need to be authenticated before we can inject PHP code. Trying the default username and password admin:admin worked perfectly as expected.\nI followed the Proof of Concept (PoC) from the above URL by creating a web page from the ‚ÄúWebsites‚Äù tab, then changing the HTML source to add our PHP reverse shell payload and get a reverse shell.\nThe PHP code is flagged as disabled; however, it‚Äôs still possible to inject PHP code as the Test user by typing \u003c?PHP code‚Ä¶?\u003e instead of \u003c?php code..?\u003e.\nBefore injecting, I have netcat actively listening on port 6969. (nc -nvlp 6969)\nOnce the injected payload is executed and we visit the site, I can see the shell popped up in my netcat session. I will quickly stabilize the shell with a Python TTY shell. With the shell as www-data, I will run LinPEAS to see if we have a vector to laterally move to the user Larissa.\nAfter enumerating on my own without using LinPEAS, I found interesting stuff in /var/www/html/crm.board.htb/htdocs/conf/conf.php.\n$dolibarr_main_url_root='http://crm.board.htb'; $dolibarr_main_document_root='/var/www/html/crm.board.htb/htdocs'; $dolibarr_main_url_root_alt='/custom'; $dolibarr_main_document_root_alt='/var/www/html/crm.board.htb/htdocs/custom'; $dolibarr_main_data_root='/var/www/html/crm.board.htb/documents'; $dolibarr_main_db_host='localhost'; $dolibarr_main_db_port='3306'; $dolibarr_main_db_name='dolibarr'; $dolibarr_main_db_prefix='llx_'; $dolibarr_main_db_user='dolibarrowner'; $dolibarr_main_db_pass='serverfun2$2023!!'; $dolibarr_main_db_type='mysqli'; $dolibarr_main_db_character_set='utf8'; $dolibarr_main_db_collation='utf8_unicode_ci'; // Authentication settings $dolibarr_main_authentication='dolibarr'; //$dolibarr_main_demo='autologin,autopass'; // Security settings $dolibarr_main_prod='0'; $dolibarr_main_force_https='0'; $dolibarr_main_restrict_os_commands='mysqldump, mysql, pg_dump, pgrestore'; $dolibarr_nocsrfcheck='0'; $dolibarr_main_instance_unique_id='ef9a8f59524328e3c36894a9ff0562b5'; $dolibarr_mailing_limit_sendbyweb='0'; $dolibarr_mailing_limit_sendbycli='0'; Here in this config file, I found the database username and password. I will use the MySQL command like this to log in to the database:\nmysql -u dolibarrowner -p (and password as: serverfun2$2023!!)\nI can see the database names with SHOW DATABASES; too, but we already know the database name from the above config. I will select this database using use dolibarr; and try to see the available tables using SHOW TABLES;. I then executed:\nSELECT * FROM llx_user; I selected the interesting stuff from MySQL.\nmysql\u003e select admin, pass_crypted, api_key, firstname, lastname from llx_user; +-------+--------------------------------------------------------------+--------------+-----------+------------+ | admin | pass_crypted | api_key | firstname | lastname | +-------+--------------------------------------------------------------+--------------+-----------+------------+ | 1 | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm | NULL | | SuperAdmin | | 0 | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 | yr6V3pXd9QEI | | admin | +-------+--------------------------------------------------------------+--------------+-----------+------------+ 2 rows in set (0.00 sec) I attempted to crack the first hash, which unfortunately remained uncracked. However, after a bit of frustration, I realized that the user password and the database password are the same. So, I SSHed to the user account with:\nssh larissa@board.htb and used the password (serverfun2$2023!!) obtained from the conf.php file. And there we go, we have the user flag now.\nRoot Flag I quickly transferred LinPEAS to the target machine and ran it to see if there is any privilege escalation vector.\nHowever, what I noticed is that this box had desktop, document, and picture files in the /home/larissa directory, which is not normal for a typical Linux server. This anomaly is likely due to the desktop environment installed on this box. So, I quickly tried to enumerate what desktop environment this box uses. It turns out this box uses version 0.23.1 of the Enlightenment desktop environment.\nAfter conducting some research, I found a working privilege escalation CVE associated with this desktop environment. The Proof of Concept (PoC) of the CVE can be found at: https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit.\nThe Enlightenment Version: 0.25.3 is indeed vulnerable to local privilege escalation. The vulnerability lies in Enlightenment_sys before version 0.25.3, which allows local users to gain privileges because it is setuid root. The issue arises from the mishandling of pathnames that begin with a /dev/.. substring. If an attacker has local access to a machine on which Enlightenment is installed, they can exploit this vulnerability to execute potentially dangerous actions.\nI created an exploit.sh script in the /tmp directory and granted it execute permissions with chmod +x exploit.sh. Then, I executed the bash script downloaded from the GitHub link of the PoC, and, boom, we obtained a root shell.\nConclusion Thanks for following my write-up. Keep learning and happy hacking! üôÇ\n",
  "wordCount" : "1269",
  "inLanguage": "en",
  "image": "http://localhost:1313/posts/writeups/hackthebox/boardlight/feature.png","datePublished": "2024-10-10T00:00:00Z",
  "dateModified": "2024-10-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/writeups/hackthebox/boardlight/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rezy Dev",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="rezydev.xyz (Alt + H)">rezydev.xyz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="‚úçÔ∏è Posts">
                    <span>‚úçÔ∏è Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="üîç Search">
                    <span>üîç Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="üè∑Ô∏è Tags">
                    <span>üè∑Ô∏è Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/whoami/" title="üë®üèº‚Äçüíª Whoami">
                    <span>üë®üèº‚Äçüíª Whoami</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/">Posts</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/writeups/">Writeups</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/writeups/hackthebox/">HackTheBox</a></div>
    <h1 class="post-title entry-hint-parent">
      BoardLight Writeup - HackTheBox
    </h1>
    <div class="post-description">
      BoardLight is an easy difficulty Linux machine that features a Dolibarr instance vulnerable to [CVE-2023-30253](https://nvd.nist.gov/vuln/detail/CVE-2023-30253). This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via [CVE-2022-37706](https://nvd.nist.gov/vuln/detail/CVE-2022-37706) and can be abused to leverage a root shell.
    </div>
    <div class="post-meta"><span title='2024-10-10 00:00:00 +0000 UTC'>October 10, 2024</span>&nbsp;¬∑&nbsp;6 min&nbsp;¬∑&nbsp;1269 words&nbsp;¬∑&nbsp;Me&nbsp;|&nbsp;<a href="https://github.com/Rezy-Dev/Rezy-Dev.github.io/tree/master/content/posts/writeups/HackTheBox/BoardLight/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a></li>
    <li><a href="#user-flag">User Flag</a></li>
    <li><a href="#root-flag">Root Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><table>
  <thead>
      <tr>
          <th>Link:</th>
          <th><a href="https://app.hackthebox.com/machines/BoardLight">https://app.hackthebox.com/machines/BoardLight</a></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Difficulty</td>
          <td>Easy</td>
      </tr>
      <tr>
          <td>Machine</td>
          <td>Linux</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="enumeration">Enumeration<a hidden class="anchor" aria-hidden="true" href="#enumeration">#</a></h2>
<p>I ran the Nmap command to find all available open ports on this system using the command: <code>nmap 10.10.11.11 -T4 -vv</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">**PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack**
</span></span></code></pre></div><p>Again, I ran an aggressive scan using the command: <strong><code>sudo nmap 10.10.11.11 -T4 -p22,80 -A -sC -sV -O -vv</code></strong>. While it ran, I was looking at port 80 and enumerating the web server.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">PORT   STATE SERVICE REASON         VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA)
</span></span><span class="line"><span class="cl">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDH0dV4gtJNo8ixEEBDxhUId6Pc/8iNLX16+zpUCIgmxxl5TivDMLg2JvXorp4F2r8ci44CESUlnMHRSYNtlLttiIZHpTML7ktFHbNexvOAJqE1lIlQlGjWBU1hWq6Y6n1tuUANOd5U+Yc0/h53gKu5nXTQTy1c9CLbQfaYvFjnzrR3NQ6Hw7ih5u3mEjJngP+Sq+dpzUcnFe1BekvBPrxdAJwN6w+MSpGFyQSAkUthrOE4JRnpa6jSsTjXODDjioNkp2NLkKa73Yc2DHk3evNUXfa+P8oWFBk8ZXSHFyeOoNkcqkPCrkevB71NdFtn3Fd/Ar07co0ygw90Vb2q34cu1Jo/1oPV1UFsvcwaKJuxBKozH+VA0F9hyriPKjsvTRCbkFjweLxCib5phagHu6K5KEYC+VmWbCUnWyvYZauJ1/t5xQqqi9UWssRjbE1mI0Krq2Zb97qnONhzcclAPVpvEVdCCcl0rYZjQt6VI1PzHha56JepZCFCNvX3FVxYzEk=
</span></span><span class="line"><span class="cl">|   256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA)
</span></span><span class="line"><span class="cl">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK7G5PgPkbp1awVqM5uOpMJ/xVrNirmwIT21bMG/+jihUY8rOXxSbidRfC9KgvSDC4flMsPZUrWziSuBDJAra5g=
</span></span><span class="line"><span class="cl">|   256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519)
</span></span><span class="line"><span class="cl">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILHj/lr3X40pR3k9+uYJk4oSjdULCK0DlOxbiL66ZRWg
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span class="line"><span class="cl">|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
</span></span><span class="line"><span class="cl">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span><span class="line"><span class="cl">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
</span></span><span class="line"><span class="cl">Aggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)
</span></span><span class="line"><span class="cl">No exact OS matches for host (test conditions non-ideal).
</span></span><span class="line"><span class="cl">TCP/IP fingerprint:
</span></span><span class="line"><span class="cl">SCAN(V=7.94SVN%E=4%D=5/26%OT=22%CT=%CU=35758%PV=Y%DS=2%DC=T%G=N%TM=6652CBFE%P=x86_64-pc-linux-gnu)
</span></span><span class="line"><span class="cl">SEQ(SP=107%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)
</span></span><span class="line"><span class="cl">OPS(O1=M552ST11NW7%O2=M552ST11NW7%O3=M552NNT11NW7%O4=M552ST11NW7%O5=M552ST11NW7%O6=M552ST11)
</span></span><span class="line"><span class="cl">WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)
</span></span><span class="line"><span class="cl">ECN(R=Y%DF=Y%T=40%W=FAF0%O=M552NNSNW7%CC=Y%Q=)
</span></span><span class="line"><span class="cl">T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)
</span></span><span class="line"><span class="cl">T2(R=N)
</span></span><span class="line"><span class="cl">T3(R=N)
</span></span><span class="line"><span class="cl">T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
</span></span><span class="line"><span class="cl">U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)
</span></span><span class="line"><span class="cl">IE(R=Y%DFI=N%T=40%CD=S)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uptime guess: 29.321 days (since Fri Apr 26 18:00:39 2024)
</span></span><span class="line"><span class="cl">Network Distance: 2 hops
</span></span><span class="line"><span class="cl">TCP Sequence Prediction: Difficulty=263 (Good luck!)
</span></span><span class="line"><span class="cl">IP ID Sequence Generation: All zeros
</span></span><span class="line"><span class="cl">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TRACEROUTE (using port 22/tcp)
</span></span><span class="line"><span class="cl">HOP RTT      ADDRESS
</span></span><span class="line"><span class="cl">1   95.49 ms 10.10.14.1
</span></span><span class="line"><span class="cl">2   91.74 ms 10.10.11.11
</span></span></code></pre></div><p>This is what the website looks like.</p>
<p><img alt="Untitled" loading="lazy" src="/posts/writeups/hackthebox/boardlight/BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled.png"></p>
<p>I checked the newsletter form, contact form, and looked around the website. It doesn‚Äôt seem to work at all, so the injection point is probably not in this asset. We can try subdomain brute forcing and directory brute forcing now.</p>
<p>I will first conduct directory brute forcing using Gobuster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ gobuster dir -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) <span class="err">&amp;</span> Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://board.htb/
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 90
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/images               (Status: 301) [Size: 307] [--&gt; http://board.htb/images/]
</span></span><span class="line"><span class="cl">/css                  (Status: 301) [Size: 304] [--&gt; http://board.htb/css/]
</span></span><span class="line"><span class="cl">/js                   (Status: 301) [Size: 303] [--&gt; http://board.htb/js/]
</span></span><span class="line"><span class="cl">/server-status        (Status: 403) [Size: 274]
</span></span></code></pre></div><p>Nothing interesting with the directories. We might check the JS and source codes, but they don‚Äôt seem promising at the moment. Before checking the source code, we can try subdomain brute forcing using Gobuster again:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ gobuster vhost -u http://board.htb/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 90 --append-domain --exclude-length 301
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) <span class="err">&amp;</span> Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:              http://board.htb/
</span></span><span class="line"><span class="cl">[+] Method:           GET
</span></span><span class="line"><span class="cl">[+] Threads:          90
</span></span><span class="line"><span class="cl">[+] Wordlist:         /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">[+] User Agent:       gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:          10s
</span></span><span class="line"><span class="cl">[+] Append Domain:    true
</span></span><span class="line"><span class="cl">[+] Exclude Length:   301
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in VHOST enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Found: crm.board.htb Status: 200 [Size: 6360]
</span></span><span class="line"><span class="cl">Found: CRM.board.htb Status: 200 [Size: 6360]
</span></span></code></pre></div><p>I added the newly found subdomain to my <code>/etc/hosts</code> file to gain access to it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
</span></span><span class="line"><span class="cl">‚îî‚îÄ# cat /etc/hosts
</span></span><span class="line"><span class="cl">127.0.0.1       localhost
</span></span><span class="line"><span class="cl">127.0.1.1       kali
</span></span><span class="line"><span class="cl">::1             localhost ip6-localhost ip6-loopback
</span></span><span class="line"><span class="cl">ff02::1         ip6-allnodes
</span></span><span class="line"><span class="cl">ff02::2         ip6-allrouters
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">10.10.11.11 board.htb crm.board.htb
</span></span></code></pre></div><p>Accessing the web page, we see it‚Äôs Dolibarr 17.0.0. Dolibarr ERP &amp; CRM is modular business management software that adapts to the size of the company (SMEs, large companies, freelancers, or associations).</p>
<p><img alt="Untitled" loading="lazy" src="/posts/writeups/hackthebox/boardlight/BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%201.png"></p>
<p>After doing a few research on this version of Dolibarr, I found a CVE associated with it: <a href="https://www.swascan.com/security-advisory-dolibarr-17-0-0/">https://www.swascan.com/security-advisory-dolibarr-17-0-0/</a></p>
<h2 id="user-flag">User Flag<a hidden class="anchor" aria-hidden="true" href="#user-flag">#</a></h2>
<p>This CVE allows us to execute Authenticated PHP Code Injection. So we need to be authenticated before we can inject PHP code. Trying the default username and password <strong><code>admin:admin</code></strong> worked perfectly as expected.</p>
<p>I followed the Proof of Concept (PoC) from the above URL by creating a web page from the ‚ÄúWebsites‚Äù tab, then changing the HTML source to add our PHP reverse shell payload and get a reverse shell.</p>
<p><img alt="Untitled" loading="lazy" src="/posts/writeups/hackthebox/boardlight/BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%202.png"></p>
<p>The PHP code is flagged as disabled; however, it‚Äôs still possible to inject PHP code as the Test user by typing <strong><code>&lt;?PHP code‚Ä¶?&gt;</code></strong> instead of <strong><code>&lt;?php code..?&gt;</code></strong>.</p>
<p><img alt="Untitled" loading="lazy" src="/posts/writeups/hackthebox/boardlight/BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%203.png"></p>
<p>Before injecting, I have netcat actively listening on port 6969. (nc -nvlp 6969)</p>
<p>Once the injected payload is executed and we visit the site, I can see the shell popped up in my netcat session. I will quickly stabilize the shell with a Python TTY shell. With the shell as www-data, I will run LinPEAS to see if we have a vector to laterally move to the user Larissa.</p>
<p>After enumerating on my own without using LinPEAS, I found interesting stuff in <strong><code>/var/www/html/crm.board.htb/htdocs/conf/conf.php</code></strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">$dolibarr_main_url_root=&#39;http://crm.board.htb&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_document_root=&#39;/var/www/html/crm.board.htb/htdocs&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_url_root_alt=&#39;/custom&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_document_root_alt=&#39;/var/www/html/crm.board.htb/htdocs/custom&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_data_root=&#39;/var/www/html/crm.board.htb/documents&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_host=&#39;localhost&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_port=&#39;3306&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_name=&#39;dolibarr&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_prefix=&#39;llx_&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_user=&#39;dolibarrowner&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_pass=&#39;serverfun2$2023!!&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_type=&#39;mysqli&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_character_set=&#39;utf8&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_db_collation=&#39;utf8_unicode_ci&#39;;
</span></span><span class="line"><span class="cl">// Authentication settings
</span></span><span class="line"><span class="cl">$dolibarr_main_authentication=&#39;dolibarr&#39;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//$dolibarr_main_demo=&#39;autologin,autopass&#39;;
</span></span><span class="line"><span class="cl">// Security settings
</span></span><span class="line"><span class="cl">$dolibarr_main_prod=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_force_https=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_restrict_os_commands=&#39;mysqldump, mysql, pg_dump, pgrestore&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_nocsrfcheck=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_main_instance_unique_id=&#39;ef9a8f59524328e3c36894a9ff0562b5&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_mailing_limit_sendbyweb=&#39;0&#39;;
</span></span><span class="line"><span class="cl">$dolibarr_mailing_limit_sendbycli=&#39;0&#39;;
</span></span></code></pre></div><p>Here in this config file, I found the database username and password. I will use the MySQL command like this to log in to the database:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -u dolibarrowner -p
</span></span></code></pre></div><p>(and password as: <strong><code>serverfun2$2023!!</code></strong>)</p>
<p>I can see the database names with <strong><code>SHOW DATABASES;</code></strong> too, but we already know the database name from the above config. I will select this database using <strong><code>use dolibarr;</code></strong> and try to see the available tables using <strong><code>SHOW TABLES;</code></strong>. I then executed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">llx_user</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>I selected the interesting stuff from MySQL.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">mysql&gt; select admin, pass_crypted, api_key, firstname, lastname from llx_user;
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">| admin | pass_crypted                                                 | api_key      | firstname | lastname   |
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">|     1 | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm | NULL         |           | SuperAdmin |
</span></span><span class="line"><span class="cl">|     0 | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 | yr6V3pXd9QEI |           | admin      |
</span></span><span class="line"><span class="cl">+-------+--------------------------------------------------------------+--------------+-----------+------------+
</span></span><span class="line"><span class="cl">2 rows in set (0.00 sec)
</span></span></code></pre></div><p>I attempted to crack the first hash, which unfortunately remained uncracked. However, after a bit of frustration, I realized that the user password and the database password are the same. So, I SSHed to the user account with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh larissa@board.htb
</span></span></code></pre></div><p>and used the password (<strong><code>serverfun2$2023!!</code></strong>) obtained from the <strong><code>conf.php</code></strong> file. And there we go, we have the user flag now.</p>
<h2 id="root-flag">Root Flag<a hidden class="anchor" aria-hidden="true" href="#root-flag">#</a></h2>
<p>I quickly transferred LinPEAS to the target machine and ran it to see if there is any privilege escalation vector.</p>
<p>However, what I noticed is that this box had desktop, document, and picture files in the <strong><code>/home/larissa</code></strong> directory, which is not normal for a typical Linux server. This anomaly is likely due to the desktop environment installed on this box. So, I quickly tried to enumerate what desktop environment this box uses. It turns out this box uses version 0.23.1 of the Enlightenment desktop environment.</p>
<p><img alt="Untitled" loading="lazy" src="/posts/writeups/hackthebox/boardlight/BoardLight%20ef1d86f4c0bc4c468c1bec1f95968b7d/Untitled%204.png"></p>
<p>After conducting some research, I found a working privilege escalation CVE associated with this desktop environment. The Proof of Concept (PoC) of the CVE can be found at: <a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit</a>.</p>
<p>The Enlightenment Version: 0.25.3 is indeed vulnerable to local privilege escalation. The vulnerability lies in <strong><code>Enlightenment_sys</code></strong> before version 0.25.3, which allows local users to gain privileges because it is setuid root. The issue arises from the mishandling of pathnames that begin with a <strong><code>/dev/..</code></strong> substring. If an attacker has local access to a machine on which Enlightenment is installed, they can exploit this vulnerability to execute potentially dangerous actions.</p>
<p>I created an <strong><code>exploit.sh</code></strong> script in the <strong><code>/tmp</code></strong> directory and granted it execute permissions with <strong><code>chmod +x exploit.sh</code></strong>. Then, I executed the bash script downloaded from the GitHub link of the PoC, and, boom, we obtained a root shell.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Thanks for following my write-up. Keep learning and happy hacking! üôÇ</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/hackthebox/">HackTheBox</a></li>
      <li><a href="http://localhost:1313/tags/linux/">Linux</a></li>
      <li><a href="http://localhost:1313/tags/easy/">Easy</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on x"
            href="https://x.com/intent/tweet/?text=BoardLight%20Writeup%20-%20HackTheBox&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f&amp;hashtags=HackTheBox%2cLinux%2cEasy">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f&amp;title=BoardLight%20Writeup%20-%20HackTheBox&amp;summary=BoardLight%20Writeup%20-%20HackTheBox&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f&title=BoardLight%20Writeup%20-%20HackTheBox">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on whatsapp"
            href="https://api.whatsapp.com/send?text=BoardLight%20Writeup%20-%20HackTheBox%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on telegram"
            href="https://telegram.me/share/url?text=BoardLight%20Writeup%20-%20HackTheBox&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share BoardLight Writeup - HackTheBox on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=BoardLight%20Writeup%20-%20HackTheBox&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fhackthebox%2fboardlight%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Rezy Dev</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
